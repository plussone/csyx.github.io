!function(){var l,u,f,d,b,n,m,s,a,r,e,i,t,o,c,g=0,p={"":"",Webkit:"webkit",Moz:"",O:"o",ms:"ms"},v=document.createElement("p");Object.keys(p).some(function(t){if(void 0!==v.style[t+(t?"T":"t")+"ransitionProperty"])return e=t?"-"+t.toLowerCase()+"-":"",i=p[t],!0});var h=(t={cssPrefix:e,transform:(c="Transform",c=c.toLowerCase(),e?e+c:c),transitionEnd:(o="TransitionEnd",i?i+o:o.toLowerCase())}).transform,y=t.transitionEnd;function E(e){s=e.getPrize,a=e.gotBack,e.config(function(t){n=e.prizes=t,b=n.length,function(t){if(!(t=t||{}).id||b>>>0==0)return;var e,n=t.id,a=360/b/2+90,s=document.createElement("ul"),r=1/b,i=[];if(u=l(n),d=u.querySelector(".gb-turntable-canvas"),f=u.querySelector(".gb-turntable-container"),m=u.querySelector(".gb-turntable-btn"),!d.getContext)return alert("抱歉！浏览器不支持。");e=d.getContext("2d");for(var o=0;o<b;o++){e.save(),e.beginPath(),e.translate(150,150),e.moveTo(0,0),e.rotate((360/b*o-a)*Math.PI/180),e.arc(0,0,150,0,2*Math.PI/b,!1),e.fillStyle=o%2==0?"#ffb820":"#ffcb3f",e.fill(),e.lineWidth=.5,e.strokeStyle="#e4370e",e.stroke(),e.restore();var c=t.prizes;i.push('<li class="gb-turntable-item"> <span style="'),i.push(h+": rotate("+o*r+'turn)">'),c[o].img?i.push('<img src="'+c[o].img+'" />'):i.push(c[o].text),i.push("</span> </li>"),o+1===b&&(s.className="gb-turntalbe-list",f.appendChild(s),s.innerHTML=i.join(""))}}(e)}),w(m,"click",function(){var t,e,n,a;a="disabled",(n=m).classList?n.classList.add(a):(e=a,!(!(t=n)||!e)&&(t.classList?t.classList.contains(e):t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)")))||(n.className+=""+a)),s(function(t){var e;r={prizeId:t[0],chances:t[1]},g=(g=g||0)+(360-g%360)+(3600-t[0]*(360/b)),e=g,f.style[h]="rotate("+e+"deg)"}),w(f,y,L)})}function L(){var t,e;r.chances&&(e="disabled",(t=m).classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," ")),a(n[r.prizeId].text)}function w(t,e,n){"function"==typeof addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}l=function(t){return document.getElementById(t)};var k={init:function(t){return E(t)}};void 0===window.gbTurntable&&(window.gbTurntable=k),"function"==typeof define&&define.amd&&define("GB-canvas-turntable",[],function(){return k})}();